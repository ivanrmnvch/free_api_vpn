services:
  api-gateway:
    # todo добавить healthcheck
    build:
      dockerfile: Dockerfile
      args:
        APP_MODE: ${APP_MODE}
    image: api-gateway:${APP_MODE}
    container_name: api-gateway_${APP_MODE}
    restart: always
    # profiles: [ 'dev']
#    depends_on:
#      postgres:
#        condition: service_healthy
    ports:
      - "8082:8082"
    env_file:
      - ./.env
    develop:
      watch:
        - path: ./package.json
          action: rebuild
        - path: ./src
          target: /api-gateway/src
          action: sync
    networks:
      - xray_vpn_services_network

networks:
  xray_vpn_services_network:
    external: true
